export default function handler(req, res) {
  // ?????? ????? ?? ??????
  const { name } = req.query;
  // ??? ?? ???? ?????? ?????? "????? ????"
  const guestName = name ? name : "????? ????";

  // ??????? ????? (?????? ?? ????)
  const YOUR_CLOUD_NAME = "dk7n4atdm"; 
  const YOUR_IMAGE_NAME = "mycard"; 
  const BLOGGER_URL = "https://ramadhangift.blogspot.com/";

  // ????? ????? ????? ?? ???????
  const encodedName = encodeURIComponent(guestName);

  // ???? ?????? ??????????
  const dynamicImage = `https://res.cloudinary.com/${YOUR_CLOUD_NAME}/image/upload/w_1200,h_630,c_fit/l_text:Arial_60_bold:${encodedName},g_center,co_white/${YOUR_IMAGE_NAME}.jpg`;

  const html = `
    <!DOCTYPE html>
    <html lang="ar" dir="rtl">
      <head>
        <meta charset="utf-8">
        <title>????? ?? ${guestName}</title>
        <meta property="og:title" content="????? ????? ???? ?? ${guestName} ??">
        <meta property="og:description" content="???? ??? ?????? ???? ?????? ?????? ?????????">
        <meta property="og:image" content="${dynamicImage}">
        <meta property="og:type" content="website">
        
        <!-- ????? ?????? ??????? -->
        <script>
            window.location.href = "${BLOGGER_URL}";
        </script>
      </head>
      <body>
        <h1 style="text-align:center; margin-top:50px;">???? ??????...</h1>
      </body>
    </html>
  `;

  res.setHeader('Content-Type', 'text/html; charset=utf-8');
  res.status(200).send(html);
}
